# tbot
## Сеточный бот для Тинькофф Инвестиций

В корне директории есть файл config_example.json<br>
поменяйте название на config.json, и заполните поля внутри него:<br>
1я строчка - токен<br>
2я строчка - account id<br>
ниже заполните настройки по бумагами.<br>

Например, если напишите<br>
```
"TCS": {"number": 8, "price_step": 0.03, "quantity": 1, "start_price": 0}
```
то торговля будет вестись бумагами Тинькофф банка, тикер TCS<br>
будет выставлено 4 ордера на покупку и 4 ордера на продажу,<br>
ордера будут с шагом в 3%,<br>
в ордерах будет по 1 акции,<br>
ордера будут выставляться от текущей цены,<br>
Следующей строкой можно задать так же вторую бумагу и последующие<br>
<br>
Оптимально, чтобы у вас были 4 бумаги TCS и деньги еще на 4 акции.<br>
Если этого нет — бот будет пытаться выставить соответствующие ордера,<br>
но вылетать не будет.<br>
Если цена упадет и бот купит одну бумагу TCS,<br>
он выставит ордер на продажу по цене = цена покупки + price_step<br>
Таким образом у вас будет 3 ордера на покупку и 5 ордеров на продажу.<br>
Когда биржа закроется, ордера отменятся.<br>
Когда биржа откроется, бот перевыставит ордера по тем же параметрам.<br>



## Начало работы

```
$ pip install tinkoff-investments
```

- [Документация от Тинькофф](https://github.com/Tinkoff/invest-python)
<br>

## Использование в докер контейнере

Создание контейнера с зависимостями
```
docker build -t tbot .
```
Запуск бота в контейнере в без режима демона
```
docker run --rm -it -v $(pwd):/app tbot
```
Запуск бота в контейнере в режиме демона
```
docker run --rm -d --name tbot -it -v $(pwd):/app tbot
```
Вывод логов бота в в режиме демона
```
docker logs tbot
```
Остановка бота в контейнере
```
docker stop tbot
```
Пауза бота в контейнере
```
docker pause tbot
```
Продолжение работы после паузы бота в контейнере
```
docker unpause tbot
```

Для удобства созданый sh скрипты.
Перед первым запуском не забываем дать права на запуск.
```
chmod +x *.sh
```
Варианты: build, run, rund, stop, logs, pause, unpause.
Пример запуска
```
./rund.sh
```
Также сделан скрипт, который спрашивает о необходимом действии.
```
./tbot.sh
```

В планах:<br>
<ol><li>Переписать верхние ордера с лимитных на тейк-профит.<br>
У этого решения есть два плюса:<br>
— Можно не перевыставлять ордера на продажу каждый торговый день.<br>
— Можно выставлять их на любую цену, игнорируя ограничения биржи по максмальной цене.<br>
</li>
<li>Сохранять цену последней покупки на следующий день,<br>
Иногда торги открываются с гэпом, и некорректно работает логика выставления skip-price<br>
</li>
<li>После каждой покупки выставлять стоп-лосс от цены покупки,<br>
хотя бы номинальный, на резкое падение, например, на 40%</li>
<li>
Передавать боту расписание работы биржи, чтоб не спамил круглосуточно
</li>
<li>
Корректировать Шаг цены и количество акций в ордере в зависимости от волатильности бумаги
</li>
<li>  
Выставлять ордера не точно по сетке,<br>
а в местах наименьшего сопротивления.<br>
  Например, по сетке buy ордер должен был выставиться на 199.9₽,<br>
  но уровень 200 — сильный, под ним много ордеров на покупку<br>
  если выставить 200.1₽, то большая вероятность что ордер исполнится<br>
  и если уровень 200₽ выстоит цена отскочит<br>
  а если так и будет стоять ордер 199.9₽,<br>
  то скорей всего до него не добьёт<br>
  а если добьёт, то скорей всего цена полетит вниз
</li>
</ol>
